{% extends 'spares/base.html' %}
{% load static %}

<!-- Document Title -->
{% block title %}<title>LL - Spares</title>{% endblock %}

{% block content %}
<div class="col-xl-4 col-md-6 col-sm-12 divLast">
  <div class="card shadow-none border border-300 my-4" data-component-card="data-component-card">
    <div class="card-header p-4 border-bottom border-300 bg-soft">
      <div class="row g-3 justify-content-between align-items-center">
        <div class="col-12 col-md">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square"
            viewBox="0 0 16 16">
            <path
              d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
            <path
              d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
          </svg>
        </div>
        <div class="col col-md-auto">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-zoom-in"
            viewBox="0 0 16 16">
            <path fill-rule="evenodd"
              d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" />
            <path
              d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z" />
            <path fill-rule="evenodd"
              d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z" />
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
            class="bi bi-window-fullscreen" viewBox="0 0 16 16">
            <path
              d="M3 3.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm1.5 0a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm1 .5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1Z" />
            <path
              d="M.5 1a.5.5 0 0 0-.5.5v13a.5.5 0 0 0 .5.5h15a.5.5 0 0 0 .5-.5v-13a.5.5 0 0 0-.5-.5H.5ZM1 5V2h14v3H1Zm0 1h14v8H1V6Z" />
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-printer"
            viewBox="0 0 16 16">
            <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z" />
            <path
              d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z" />
          </svg>
        </div>
      </div>
    </div>
    {% if document.svg%}
    <div class="card-body p-0">
      {{ document.svg|safe }}
    </div>
    {% else %}
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
      <g transform="translate(-3441 18387)">
        <g transform="translate(0 438)">
          <g>
            <rect width="800" height="400" transform="translate(3441 -18825)" fill="#dedede" />
            <path
              d="M5.53-53.979H17.358L38.855-16.3V-53.979h10.51V0H38.086L16.04-38.342V0H5.53ZM78.441-7.361a8.272,8.272,0,0,0,7.031-3.259q2.454-3.259,2.454-9.265t-2.454-9.247a8.29,8.29,0,0,0-7.031-3.241,8.34,8.34,0,0,0-7.05,3.241q-2.472,3.241-2.472,9.247t2.472,9.265A8.322,8.322,0,0,0,78.441-7.361ZM98.875-19.885A23.14,23.14,0,0,1,93.822-4.852Q88.768,1.392,78.478,1.392T63.133-4.852A23.14,23.14,0,0,1,58.08-19.885a23.293,23.293,0,0,1,5.054-14.978Q68.187-41.2,78.478-41.2t15.344,6.335A23.293,23.293,0,0,1,98.875-19.885Zm42.038-24.792H130.33v-9.631h10.583ZM130.33-39.917h10.583V0H130.33Zm66.8-.879a13.894,13.894,0,0,1,5.2,1.025,11.6,11.6,0,0,1,4.651,3.589,11.467,11.467,0,0,1,2.271,5.127,35.436,35.436,0,0,1,.366,5.9L209.54,0H198.847V-25.415a8.342,8.342,0,0,0-.732-3.735q-1.392-2.783-5.127-2.783a6,6,0,0,0-5.969,3.589,11.27,11.27,0,0,0-.842,4.578V0h-10.51V-23.767a13.348,13.348,0,0,0-.732-5.164q-1.318-2.893-5.164-2.893-4.468,0-6.006,2.893a11.147,11.147,0,0,0-.842,4.907V0H152.338V-39.844h10.144v5.823a16.8,16.8,0,0,1,3.662-4.431,12.531,12.531,0,0,1,7.874-2.344,12.452,12.452,0,0,1,7.4,2.014,11.716,11.716,0,0,1,3.442,4.8,13.271,13.271,0,0,1,5.09-5.164A15.533,15.533,0,0,1,197.125-40.8Zm45.592,21.387a11.342,11.342,0,0,1-2,1.007,16.691,16.691,0,0,1-2.765.714l-2.344.439a15.134,15.134,0,0,0-4.724,1.428,4.787,4.787,0,0,0-2.417,4.431,4.666,4.666,0,0,0,1.483,3.864,5.581,5.581,0,0,0,3.607,1.19,10.63,10.63,0,0,0,6.207-1.978q2.838-1.978,2.948-7.214Zm-6.335-4.871a16.291,16.291,0,0,0,4.138-.916,3.138,3.138,0,0,0,2.234-2.966,3.52,3.52,0,0,0-1.7-3.387,10.638,10.638,0,0,0-5-.934q-3.7,0-5.237,1.831a7.611,7.611,0,0,0-1.465,3.662H219.28a15.317,15.317,0,0,1,2.93-8.606q4.138-5.273,14.209-5.273a25.245,25.245,0,0,1,11.646,2.6q5.09,2.6,5.09,9.814v18.311q0,1.9.073,4.614a5.8,5.8,0,0,0,.623,2.783,3.742,3.742,0,0,0,1.538,1.208V0H244.036a11.625,11.625,0,0,1-.659-2.271q-.183-1.062-.293-2.417A21.444,21.444,0,0,1,238.1-.7a14.981,14.981,0,0,1-7.617,1.941,13.1,13.1,0,0,1-8.954-3.094Q218-4.944,218-10.62q0-7.361,5.676-10.657a25.2,25.2,0,0,1,9.155-2.563Zm44.676,15.71a8.063,8.063,0,0,0,6.189-2.765q2.527-2.765,2.527-8.807,0-5.676-2.4-8.643a7.841,7.841,0,0,0-6.427-2.966,7.574,7.574,0,0,0-7.581,5.164,18.312,18.312,0,0,0-1.1,6.775,15.46,15.46,0,0,0,1.172,6.189A7.638,7.638,0,0,0,281.058-8.569Zm-2.6-32.3a13.749,13.749,0,0,1,5.237.916,12.54,12.54,0,0,1,6.152,5.786v-5.75h10.144V-2.051q0,7.727-2.6,11.646-4.468,6.738-17.139,6.738-7.654,0-12.488-3a11.079,11.079,0,0,1-5.347-8.972h11.353A4.7,4.7,0,0,0,275.2,6.995q1.685,1.428,5.676,1.428,5.64,0,7.544-3.772,1.245-2.417,1.245-8.13V-6.042A12.727,12.727,0,0,1,286.441-2.2a12.959,12.959,0,0,1-8.093,2.38,15.316,15.316,0,0,1-12.286-5.4q-4.6-5.4-4.6-14.63,0-8.9,4.431-14.96T278.458-40.869Zm48.521,8.5a7.089,7.089,0,0,0-5.621,2.271,11.333,11.333,0,0,0-2.509,6.152h16.223a9.086,9.086,0,0,0-2.509-6.281A7.79,7.79,0,0,0,326.979-32.373Zm0-8.606a20.92,20.92,0,0,1,8.972,1.868,15.717,15.717,0,0,1,6.592,5.9,20.117,20.117,0,0,1,3.04,8.24,53.214,53.214,0,0,1,.33,7.91H318.593q.22,6.006,3.772,8.423a8.884,8.884,0,0,0,5.2,1.5A7.484,7.484,0,0,0,332.8-8.972a8.7,8.7,0,0,0,1.941-2.747H345.4A13.24,13.24,0,0,1,341.7-4.5q-5.127,5.823-14.355,5.823a20.243,20.243,0,0,1-13.44-4.907q-5.823-4.907-5.823-15.967,0-10.364,5.255-15.894A17.968,17.968,0,0,1,326.979-40.979Z"
              transform="translate(3667 -18604)" fill="#fff" />
          </g>
        </g>
      </g>
    </svg>
    {% endif %}
  </div>
</div>
<div class="col-xl-8 col-md-6 col-sm-12">
  <h1>{{ document.number }} {{ document.title }}</h1>

  <table id="spares" class="table table-responsive table-sm">
    <thead>
      <tr>
        <th scope="col">pos</th>
        <th scope="col">Reference</th>
        <th scope="col">Is in package</th>
        <th scope="col">Part no.</th>
        <th scope="col">Qty.</th>
        <th scope="col">Replaced part no.</th>
        <th scope="col">Designation</th>
        <th scope="col">Aditional information</th>
        <th scope="col">Note</th>
      </tr>
    </thead>
    <tbody>
      {% for part in document.part_set.all %}
      <tr>
        <th scope="row">{{ part.pos }}</th>

        <td>
          {% if part.references %}
          <div>
            <svg type="button" id='ToastBtn-{{ forloop.counter }}' class="bi bi-eye" width="24" height="24"
              fill="currentColor">
              <use xlink:href="#eye"></use>
            </svg>
            {{ forloop.counter|json_script:"ref" }}
          </div>
          <div class="toast-container position-fixed top-0 start-0 p-3">
            <div id="liveToast-{{ forloop.counter }}" class="toast" role="alert" data-bs-autohide="false">
              <div class="toast-header">
                <img src="{% static 'spares/images/favicons/favicon-32x32.png' %}" class="rounded me-2" alt="...">
                <strong class="me-auto">Link Logistik</strong>
                <small class="text-body-secondary">Multi 20.05</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>

              </div>
              <div class="toast-body">
                {{ part.references }}
              </div>
            </div>
          </div>

          {% else %}
          &nbsp;
          {% endif %}
        </td>

        <td>
          {% if part.included == True %}
          Yes
          {% else %}
          &nbsp;
          {% endif %}
        </td>

        <td>{{ part.part_no }}</td>
        <td>{{ part.qty }}</td>
        <td>{{ part.replacement }}</td>
        <td>{{ part.designation }}</td>
        <td>{{ part.additional_information }}</td>
        <td>{{ part.note }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <p>Player 1: Chris</p>
</div>
{% endblock%}

{% block script %}

<script id="ref" type="application/json">{"id": 1}</script>

<script>
  /*
  Add the Bootstrap 5 class 'table-active' to the clicked row and remove the same class from another row, if it has been set.
  */

  // Select the table element
  const table = document.getElementById("spares");

  // Get all the rows in the table
  const rows = table.getElementsByTagName("tr");

  // Attach a click event listener to each row
  for (let i = 0; i < rows.length; i++) {
    const row = rows[i];

    // Add a click event listener to the row
    row.addEventListener("click", function () {
      // Remove the "table-active" class from all rows
      for (let j = 0; j < rows.length; j++) {
        rows[j].classList.remove("table-active");
      }

      // Add the "table-active" class to the clicked row
      row.classList.add("table-active");
    });
  }

  // JavaScript to trigger toast:

  //const references = JSON.parse(document.getElementById('ref').textContent);

  const toastTrigger1 = document.getElementById('ToastBtn-1');
  console.log(toastTrigger1);
  const toastLiveExample1 = document.getElementById('liveToast-1');

  if (toastTrigger1) {
    const toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample1)
    toastTrigger1.addEventListener('click', () => {
      toastBootstrap.show()

    })
  };

  const toastTrigger2 = document.getElementById('ToastBtn-2');
  const toastLiveExample2 = document.getElementById('liveToast-2');

  if (toastTrigger2) {
    const toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample2)
    toastTrigger2.addEventListener('click', () => {
      toastBootstrap.show()
    })
  };

  const toastTrigger3 = document.getElementById('ToastBtn-3');
  const toastLiveExample3 = document.getElementById('liveToast-3');

  if (toastTrigger3) {
    const toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample3)
    toastTrigger3.addEventListener('click', () => {
      toastBootstrap.show()
    })
  };

  const toastTrigger4 = document.getElementById('ToastBtn-4');
  const toastLiveExample4 = document.getElementById('liveToast-4');

  if (toastTrigger2) {
    const toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample4)
    toastTrigger4.addEventListener('click', () => {
      toastBootstrap.show()
    })
  };


</script>
<script>
  const para = document.querySelector("p");

  para.addEventListener("click", updateName);

  function updateName() {
    const name = prompt("Enter a new name");
    para.textContent = `Player 1: ${name}`;
  }
</script>
{% endblock%}